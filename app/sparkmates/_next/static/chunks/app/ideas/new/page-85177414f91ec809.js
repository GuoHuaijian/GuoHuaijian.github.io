(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{81138:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>w});var l=r(95155),s=r(12115),i=r(52269),a=r(9670),n=r(55857),d=r(54265),o=r(81063),x=r(3951),c=r(32582),u=r(77498),h=r(80329),b=r(7782),g=r(50095),A=r(83025),j=r(20071),p=r(80158),m=r(44146),v=r(89915),f=r(29414),y=r(33964),k=r(71023),C=r(35695),S=r(25680),I=r(24988),R=r(36971);let w=()=>{let{user:e}=(0,S.A)(),t=(0,C.useRouter)(),[r,w]=(0,s.useState)(!1),[P,W]=(0,s.useState)(!1),[B,D]=(0,s.useState)(null),[E,_]=(0,s.useState)(""),[O,q]=(0,s.useState)(""),[L,N]=(0,s.useState)(""),[U,F]=(0,s.useState)("PUBLIC"),[T,Y]=(0,s.useState)([]),[z,H]=(0,s.useState)(""),[K,V]=(0,s.useState)(null),[G,J]=(0,s.useState)(null),M=(0,s.useRef)(null),Q=()=>{z&&!T.includes(z)&&T.length<5&&(Y([...T,z]),H(""))},X=e=>{Y(T.filter(t=>t!==e))},Z=async r=>{if(r.preventDefault(),!E||!O||!L){D("请填写所有必填字段");return}try{w(!0),D(null);let r={title:E,description:O,category:L,visibility:U,tags:T,userId:(null==e?void 0:e.id)||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),likes:0,views:0,comments:0},l=await R.f3.create(r);W(!0),setTimeout(()=>{t.push("/ideas/".concat(l.id))},1500)}catch(e){console.error("Error creating idea:",e),D("创建创意时出错，请稍后再试")}finally{w(!1)}};return e?(0,l.jsxs)(I.A,{sx:{mt:8},children:[(0,l.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",mb:4,position:"relative","&::before":{content:'""',position:"absolute",left:0,top:"50%",width:4,height:"40px",transform:"translateY(-50%)",background:"linear-gradient(to bottom, #1976d2, #42a5f5)",borderRadius:"0 4px 4px 0"},pl:3},children:[(0,l.jsx)(n.A,{startIcon:(0,l.jsx)(f.A,{}),onClick:()=>t.back(),sx:{mr:2},children:"返回"}),(0,l.jsxs)(i.A,{children:[(0,l.jsx)(a.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:700},children:"发布新创意"}),(0,l.jsx)(a.A,{variant:"body1",color:"text.secondary",children:"分享您的创意，寻找志同道合的合作伙伴"})]})]}),B&&(0,l.jsx)(d.A,{severity:"error",sx:{mb:3},children:B}),P&&(0,l.jsx)(d.A,{severity:"success",sx:{mb:3},children:"创意发布成功！正在跳转到创意详情页..."}),(0,l.jsx)(o.A,{elevation:0,sx:{p:4,borderRadius:2,border:"1px solid rgba(33, 150, 243, 0.1)",background:"linear-gradient(to right, rgba(255, 255, 255, 0.9), rgba(246, 249, 252, 0.9))"},children:(0,l.jsx)("form",{onSubmit:Z,children:(0,l.jsxs)(x.Ay,{container:!0,spacing:3,children:[(0,l.jsx)(x.Ay,{item:!0,xs:12,children:(0,l.jsx)(c.A,{label:"创意标题",placeholder:"为您的创意取一个吸引人的标题",fullWidth:!0,required:!0,value:E,onChange:e=>_(e.target.value),variant:"outlined",InputProps:{sx:{borderRadius:1.5}}})}),(0,l.jsx)(x.Ay,{item:!0,xs:12,children:(0,l.jsx)(c.A,{label:"创意描述",placeholder:"详细描述您的创意，包括背景、目标、潜在价值等",fullWidth:!0,required:!0,multiline:!0,rows:6,value:O,onChange:e=>q(e.target.value),variant:"outlined",InputProps:{sx:{borderRadius:1.5}}})}),(0,l.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,l.jsxs)(u.A,{fullWidth:!0,required:!0,children:[(0,l.jsx)(h.A,{id:"category-label",children:"创意分类"}),(0,l.jsx)(b.A,{labelId:"category-label",value:L,label:"创意分类",onChange:e=>N(e.target.value),sx:{borderRadius:1.5},children:["技术创新","艺术设计","社会创业","教育创新","环保项目","健康医疗","其他"].map(e=>(0,l.jsx)(g.A,{value:e,children:e},e))})]})}),(0,l.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,l.jsxs)(u.A,{fullWidth:!0,children:[(0,l.jsx)(h.A,{id:"visibility-label",children:"可见性"}),(0,l.jsxs)(b.A,{labelId:"visibility-label",value:U,label:"可见性",onChange:e=>F(e.target.value),sx:{borderRadius:1.5},children:[(0,l.jsx)(g.A,{value:"PUBLIC",children:"公开"}),(0,l.jsx)(g.A,{value:"PRIVATE",children:"私密"})]}),(0,l.jsx)(A.A,{children:"公开的创意对所有人可见，私密创意仅对您可见"})]})}),(0,l.jsxs)(x.Ay,{item:!0,xs:12,children:[(0,l.jsxs)(i.A,{sx:{mb:1},children:[(0,l.jsx)(a.A,{variant:"subtitle2",gutterBottom:!0,children:"标签（最多5个）"}),(0,l.jsxs)(i.A,{sx:{display:"flex",alignItems:"flex-start"},children:[(0,l.jsx)(c.A,{placeholder:"添加标签",fullWidth:!0,value:z,onChange:e=>H(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),Q())},sx:{mr:1},InputProps:{sx:{borderRadius:1.5}}}),(0,l.jsx)(n.A,{variant:"outlined",onClick:Q,disabled:!z||T.length>=5,children:"添加"})]})]}),(0,l.jsx)(i.A,{sx:{mt:2,display:"flex",flexWrap:"wrap",gap:1},children:T.map(e=>(0,l.jsx)(j.A,{label:e,onDelete:()=>X(e),sx:{borderRadius:"6px",backgroundColor:"rgba(33, 150, 243, 0.08)",color:"#1976d2",border:"1px solid rgba(33, 150, 243, 0.12)"}},e))})]}),(0,l.jsxs)(x.Ay,{item:!0,xs:12,children:[(0,l.jsx)(p.A,{sx:{my:2}}),(0,l.jsx)(a.A,{variant:"subtitle2",gutterBottom:!0,children:"上传封面图片（可选）"}),(0,l.jsx)("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:e=>{let t=e.target.files&&e.target.files[0];if(t){V(t);let e=new FileReader;e.onload=()=>{J(e.result)},e.readAsDataURL(t)}},ref:M}),G?(0,l.jsxs)(i.A,{sx:{mt:2,position:"relative"},children:[(0,l.jsx)("img",{src:G,alt:"Preview",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"8px",objectFit:"cover"}}),(0,l.jsx)(m.A,{onClick:()=>{V(null),J(null),M.current&&(M.current.value="")},sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.6)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.8)"}},children:(0,l.jsx)(k.A,{})})]}):(0,l.jsx)(n.A,{variant:"outlined",startIcon:(0,l.jsx)(y.A,{}),onClick:()=>{var e;return null===(e=M.current)||void 0===e?void 0:e.click()},sx:{borderRadius:1.5,p:1.5,borderStyle:"dashed"},children:"选择图片"})]}),(0,l.jsxs)(x.Ay,{item:!0,xs:12,sx:{mt:3,display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(n.A,{variant:"outlined",onClick:()=>t.back(),sx:{mr:2},children:"取消"}),(0,l.jsx)(n.A,{type:"submit",variant:"contained",disabled:r||!E||!O||!L,startIcon:r&&(0,l.jsx)(v.A,{size:20,color:"inherit"}),sx:{minWidth:120,background:"linear-gradient(45deg, #1976d2 30%, #42a5f5 90%)",transition:"all 0.3s ease","&:hover":{background:"linear-gradient(45deg, #0d47a1 30%, #1976d2 90%)",boxShadow:"0 6px 20px rgba(33, 150, 243, 0.3)",transform:"translateY(-2px)"}},children:r?"提交中...":"发布创意"})]})]})})})]}):(0,l.jsx)(I.A,{children:(0,l.jsxs)(i.A,{sx:{textAlign:"center",py:8},children:[(0,l.jsx)(a.A,{variant:"h6",gutterBottom:!0,children:"请先登录"}),(0,l.jsx)(a.A,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"您需要登录才能发布创意"}),(0,l.jsx)(n.A,{variant:"contained",onClick:()=>t.push("/login"),sx:{mt:2},children:"前往登录"})]})})}},99762:(e,t,r)=>{Promise.resolve().then(r.bind(r,81138))}},e=>{var t=t=>e(e.s=t);e.O(0,[827,364,34,951,948,582,644,680,988,441,684,358],()=>t(99762)),_N_E=e.O()}]);