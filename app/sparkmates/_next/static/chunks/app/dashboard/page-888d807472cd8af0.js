(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{25655:(e,s,n)=>{Promise.resolve().then(n.bind(n,44879))},44879:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>_});var t=n(95155),i=n(12115),l=n(35695),r=n(25680),a=n(52269),c=n(89915),o=n(63159),x=n(9670),d=n(3951),h=n(81063),j=n(55398),A=n(80158),p=n(95439),m=n(40463),y=n(55592),u=n(34152),g=n(55857),b=n(84256),v=n(83339),f=n(20071),C=n(27783),w=n(9757),k=n(16295),I=n(60392),W=n(86435),S=n(94971),z=n(15843),E=n(24988),R=n(59434),Y=n(36971);let _=()=>{let e=(0,l.useRouter)(),{user:s,loading:n}=(0,r.A)(),[_,B]=(0,i.useState)([]),[F,U]=(0,i.useState)([]),[q,G]=(0,i.useState)(0),[N,P]=(0,i.useState)(0),[T,D]=(0,i.useState)(!0);if((0,i.useEffect)(()=>{n||s||e.push("/login")},[n,s,e]),(0,i.useEffect)(()=>{let e=async()=>{if(s)try{D(!0);let e=await Y.f3.getByUser(s.id);B(e);let n=await Y.hI.getByUser(s.id);U(n);let t=await Y.nK.getUnreadCount(s.id);G(t);let i=await Y.VY.getUnreadCount(s.id);P(i)}catch(e){console.error("加载仪表盘数据出错:",e)}finally{D(!1)}};s&&e()},[s]),n||!s)return(0,t.jsx)(a.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,t.jsx)(c.A,{})});let O=[{title:"发布创意",icon:(0,t.jsx)(C.A,{}),path:"/ideas/new",color:"#2563eb"},{title:"创建项目",icon:(0,t.jsx)(w.A,{}),path:"/projects/new",color:"#7c3aed"},{title:"查找合作者",icon:(0,t.jsx)(k.A,{}),path:"/community",color:"#10b981"},{title:"消息中心",icon:(0,t.jsx)(I.A,{}),path:"/messages",color:"#f59e0b"}],V=s=>()=>{e.push(s)};return(0,t.jsx)(E.A,{sx:{mt:8},children:(0,t.jsx)(a.A,{sx:{backgroundColor:"background.default",minHeight:"100vh",py:4},children:(0,t.jsxs)(o.A,{maxWidth:"lg",children:[(0,t.jsxs)(a.A,{sx:{mb:4},children:[(0,t.jsxs)(x.A,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:["欢迎回来，",null==s?void 0:s.name]}),(0,t.jsxs)(x.A,{variant:"body1",color:"text.secondary",children:["今天是 ",(0,R.Yq)(new Date().toISOString()),"，让我们来看看您的最新动态"]})]}),(0,t.jsxs)(d.Ay,{container:!0,spacing:4,children:[(0,t.jsxs)(d.Ay,{item:!0,xs:12,md:4,children:[(0,t.jsxs)(h.A,{elevation:0,sx:{p:3,mb:4,borderRadius:2},children:[(0,t.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,t.jsx)(j.A,{src:(0,R.TW)(null==s?void 0:s.avatar),alt:null==s?void 0:s.name,sx:{width:64,height:64,mr:2}}),(0,t.jsxs)(a.A,{children:[(0,t.jsx)(x.A,{variant:"h6",fontWeight:"bold",children:null==s?void 0:s.name}),(0,t.jsx)(x.A,{variant:"body2",color:"text.secondary",children:null==s?void 0:s.role})]})]}),(0,t.jsx)(A.A,{sx:{my:2}}),(0,t.jsxs)(p.A,{disablePadding:!0,children:[(0,t.jsxs)(m.Ay,{disableGutters:!0,sx:{px:0,py:.75},children:[(0,t.jsx)(y.A,{sx:{minWidth:36},children:(0,t.jsx)(C.A,{fontSize:"small",color:"primary"})}),(0,t.jsx)(u.A,{primary:(0,t.jsxs)(x.A,{variant:"body2",children:["创意: ",(0,t.jsx)("strong",{children:(null==_?void 0:_.length)||0})]})})]}),(0,t.jsxs)(m.Ay,{disableGutters:!0,sx:{px:0,py:.75},children:[(0,t.jsx)(y.A,{sx:{minWidth:36},children:(0,t.jsx)(w.A,{fontSize:"small",color:"primary"})}),(0,t.jsx)(u.A,{primary:(0,t.jsxs)(x.A,{variant:"body2",children:["项目: ",(0,t.jsx)("strong",{children:(null==F?void 0:F.length)||0})]})})]}),(0,t.jsxs)(m.Ay,{disableGutters:!0,sx:{px:0,py:.75},children:[(0,t.jsx)(y.A,{sx:{minWidth:36},children:(0,t.jsx)(I.A,{fontSize:"small",color:"primary"})}),(0,t.jsx)(u.A,{primary:(0,t.jsxs)(x.A,{variant:"body2",children:["未读消息: ",(0,t.jsx)("strong",{children:q||0})]})})]}),(0,t.jsxs)(m.Ay,{disableGutters:!0,sx:{px:0,py:.75},children:[(0,t.jsx)(y.A,{sx:{minWidth:36},children:(0,t.jsx)(W.A,{fontSize:"small",color:"primary"})}),(0,t.jsx)(u.A,{primary:(0,t.jsxs)(x.A,{variant:"body2",children:["未读通知: ",(0,t.jsx)("strong",{children:N||0})]})})]})]}),(0,t.jsx)(g.A,{fullWidth:!0,variant:"outlined",startIcon:(0,t.jsx)(S.A,{}),onClick:V("/profile"),sx:{mt:2},children:"查看个人资料"})]}),(0,t.jsxs)(h.A,{elevation:0,sx:{p:3,borderRadius:2},children:[(0,t.jsx)(x.A,{variant:"h6",fontWeight:"bold",gutterBottom:!0,children:"快速操作"}),(0,t.jsx)(d.Ay,{container:!0,spacing:2,sx:{mt:1},children:O.map((e,s)=>(0,t.jsx)(d.Ay,{item:!0,xs:6,children:(0,t.jsx)(b.A,{variant:"outlined",sx:{borderRadius:2,cursor:"pointer",transition:"all 0.2s ease","&:hover":{boxShadow:2,transform:"translateY(-4px)"}},onClick:V(e.path),children:(0,t.jsxs)(v.A,{sx:{textAlign:"center",p:2},children:[(0,t.jsx)(a.A,{sx:{color:e.color,mb:1,display:"flex",justifyContent:"center"},children:e.icon}),(0,t.jsx)(x.A,{variant:"body2",fontWeight:"medium",children:e.title})]})})},s))})]})]}),(0,t.jsxs)(d.Ay,{item:!0,xs:12,md:8,children:[(0,t.jsxs)(h.A,{elevation:0,sx:{p:3,borderRadius:2},children:[(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsx)(x.A,{variant:"h6",fontWeight:"bold",children:"最近项目"}),(0,t.jsx)(g.A,{startIcon:(0,t.jsx)(z.A,{}),onClick:V("/projects/new"),children:"创建项目"})]}),T?(0,t.jsxs)(a.A,{sx:{py:4,textAlign:"center"},children:[(0,t.jsx)(c.A,{size:28,sx:{mb:2}}),(0,t.jsx)(x.A,{children:"加载中..."})]}):F&&F.length>0?(0,t.jsx)(p.A,{children:F.slice(0,3).map((e,s)=>(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(m.Ay,{sx:{py:2,px:0,cursor:"pointer"},onClick:V("/projects/".concat(e.id)),children:(0,t.jsx)(u.A,{primary:(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(x.A,{variant:"subtitle1",fontWeight:"medium",children:e.title}),(0,t.jsx)(f.A,{label:e.status,size:"small",color:"已完成"===e.status?"success":"进行中"===e.status?"primary":"default"})]}),secondary:(0,t.jsxs)(a.A,{sx:{mt:1},component:"span",children:[(0,t.jsxs)(x.A,{variant:"body2",color:"text.secondary",sx:{mb:1},component:"span",children:[e.description.substring(0,120),"..."]}),(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},component:"span",children:[(0,t.jsxs)(a.A,{component:"span",children:[e.tags&&e.tags.slice(0,2).map((e,s)=>(0,t.jsx)(x.A,{component:"span",sx:{display:"inline-block"},children:(0,t.jsx)(f.A,{label:e,size:"small",variant:"outlined",sx:{mr:.5}})},s)),e.tags&&e.tags.length>2&&(0,t.jsxs)(x.A,{variant:"caption",component:"span",children:["+",e.tags.length-2]})]}),(0,t.jsxs)(x.A,{variant:"caption",color:"text.secondary",component:"span",children:["创建于 ",(0,R.Yq)(e.createdAt)]})]})]})})}),s<F.slice(0,3).length-1&&(0,t.jsx)(A.A,{})]},e.id))}):(0,t.jsxs)(a.A,{sx:{py:4,textAlign:"center"},children:[(0,t.jsx)(x.A,{color:"text.secondary",children:"您还没有创建任何项目"}),(0,t.jsx)(g.A,{variant:"outlined",startIcon:(0,t.jsx)(z.A,{}),onClick:V("/projects/new"),sx:{mt:2},children:"创建第一个项目"})]}),F&&F.length>3&&(0,t.jsx)(a.A,{sx:{textAlign:"center",mt:2},children:(0,t.jsx)(g.A,{onClick:V("/projects"),variant:"text",children:"查看全部项目"})})]}),(0,t.jsxs)(h.A,{elevation:0,sx:{p:3,borderRadius:2},children:[(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,t.jsx)(x.A,{variant:"h6",fontWeight:"bold",children:"最近创意"}),(0,t.jsx)(g.A,{startIcon:(0,t.jsx)(z.A,{}),onClick:V("/ideas/new"),children:"发布创意"})]}),T?(0,t.jsxs)(a.A,{sx:{py:4,textAlign:"center"},children:[(0,t.jsx)(c.A,{size:28,sx:{mb:2}}),(0,t.jsx)(x.A,{children:"加载中..."})]}):_&&_.length>0?(0,t.jsx)(p.A,{children:_.slice(0,3).map((e,s)=>(0,t.jsxs)(i.Fragment,{children:[(0,t.jsx)(m.Ay,{sx:{py:2,px:0,cursor:"pointer"},onClick:V("/ideas/".concat(e.id)),children:(0,t.jsx)(u.A,{primary:(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsx)(x.A,{variant:"subtitle1",fontWeight:"medium",children:e.title}),(0,t.jsx)(f.A,{label:e.visibility,size:"small",color:"PUBLIC"===e.visibility?"success":"PRIVATE"===e.visibility?"error":"default"})]}),secondary:(0,t.jsxs)(a.A,{sx:{mt:1},component:"span",children:[(0,t.jsxs)(x.A,{variant:"body2",color:"text.secondary",sx:{mb:1},component:"span",children:[e.description.substring(0,120),"..."]}),(0,t.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},component:"span",children:[(0,t.jsxs)(a.A,{component:"span",children:[e.tags.slice(0,2).map((e,s)=>(0,t.jsx)(x.A,{component:"span",sx:{display:"inline-block"},children:(0,t.jsx)(f.A,{label:e,size:"small",variant:"outlined",sx:{mr:.5}})},s)),e.tags.length>2&&(0,t.jsxs)(x.A,{variant:"caption",component:"span",children:["+",e.tags.length-2]})]}),(0,t.jsxs)(x.A,{variant:"caption",color:"text.secondary",component:"span",children:["创建于 ",(0,R.Yq)(e.createdAt)]})]})]})})}),s<_.slice(0,3).length-1&&(0,t.jsx)(A.A,{})]},e.id))}):(0,t.jsxs)(a.A,{sx:{py:4,textAlign:"center"},children:[(0,t.jsx)(x.A,{color:"text.secondary",children:"您还没有发布任何创意"}),(0,t.jsx)(g.A,{variant:"outlined",startIcon:(0,t.jsx)(z.A,{}),onClick:V("/ideas/new"),sx:{mt:2},children:"发布第一个创意"})]}),_&&_.length>3&&(0,t.jsx)(a.A,{sx:{textAlign:"center",mt:2},children:(0,t.jsx)(g.A,{onClick:V("/ideas"),variant:"text",children:"查看全部创意"})})]})]})]})]})})})}},59434:(e,s,n)=>{"use strict";n.d(s,{EJ:()=>r,TW:()=>t,Yq:()=>i,ZV:()=>l});let t=(e,s)=>e&&!e.includes("placeholder")?e:"/avatars/placeholder.svg",i=e=>{let s=new Date(e);return new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"long",day:"numeric"}).format(s)},l=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"k":e.toString(),r=(e,s)=>e.length<=s?e:e.slice(0,s)+"..."}},e=>{var s=s=>e(e.s=s);e.O(0,[827,364,34,951,948,836,680,988,441,684,358],()=>s(25655)),_N_E=e.O()}]);